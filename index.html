<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estudio Palíndromo</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Cormorant+Garamond:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
</head>
<body>

    <header id="page-header">
        <div class="container header-container">
            <a href="#inicio" class="header-titulo">Estudio Palíndromo</a>
            <div class="header-menu-lado">
                <a href="#la-fortuna" class="menu-circulo"><img src="imagenes/icono-fortuna.png" alt="La Fortuna"></a>
                <a href="#dante-en-la-playa" class="menu-circulo"><img src="imagenes/icono-dante.png" alt="Dante"></a>
                <a href="#poemas-apestosos" class="menu-circulo"><img src="imagenes/icono-poemas.png" alt="Poemas"></a>
            </div>
        </div>
    </header>

    <main>
        <section id="inicio" class="hero-sirena">
            <div class="hero-background">
                <img src="imagenes/sirena-portada.jpg" alt="Sirena en el mar" class="sirena-img">
            </div>
            <h1 class="titulo-hero">Contamos Historias</h1>
        </section>

        <section id="sobre-nosotros" class="seccion-contenido">
            <div class="container dark-container">
                <div class="slider-container">
                    <div class="slides">
                        <!-- Slide 1: Joshua Solana -->
                        <div class="slide">
                            <div class="about-layout">
                                <div class="about-column">
                                    <h2>Sobre Nosotros</h2>
                                    <h3>Joshua Solana</h3>
                                    <p>Soy un productor creativo, escritor cultural y educador audiovisual con experiencia en proyectos interdisciplinarios. He trabajado tanto en espacios educativos como en medios culturales, y me interesa colaborar con equipos que valoren la imaginación, la escritura y el pensamiento visual.</p>
                                    <div class="social-links-section">
                                        <a href="#" class="social-icon-circle"><img src="imagenes/linkedin-icon.png" alt="LinkedIn"></a>
                                        <a href="#" class="social-icon-circle"><img src="imagenes/imdb.png" alt="IMDb"></a>
                                        <a href="#" class="social-icon-circle"><img src="imagenes/instagram-icon.png" alt="Instagram"></a>
                                        <a href="#" class="social-icon-circle"><img src="imagenes/Mail.png" alt="Email"></a>
                                    </div>
                                </div>
                                <div class="about-column">
                                    <div class="vimeo-container">
                                        <iframe src="https://player.vimeo.com/video/824895215?h=420e6a312f" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Slide 2: Samantha -->
                        <div class="slide">
                             <div class="about-layout">
                                <div class="about-column">
                                    <h2>Sobre Nosotros</h2>
                                    <h3>Samantha Guevara</h3>
                                    <p>Texto sobre Samantha aquí.</p>
                                </div>
                                <div class="about-column">
                                   <div class="instagram-grid">
                                        <img src="imagenes/insta-sam-01.jpg" alt="Imagen de Instagram 1">
                                        <img src="imagenes/insta-sam-02.jpg" alt="Imagen de Instagram 2">
                                        <img src="imagenes/insta-sam-03.jpg" alt="Imagen de Instagram 3">
                                        <img src="imagenes/insta-sam-04.jpg" alt="Imagen de Instagram 4">
                                   </div>
                                </div>
                            </div>
                        </div>
                        <!-- Slide 3: Arthur -->
                        <div class="slide">
                             <div class="about-layout">
                                <div class="about-column">
                                    <h2>Sobre Nosotros</h2>
                                    <h3>Arthur</h3>
                                     <p>Texto sobre Arthur aquí.</p>
                                </div>
                                <div class="about-column">
                                    <img src="https://placehold.co/600x400/1a1a1a/f0f0f0?text=Imagen+Arthur" alt="Foto de Arthur" style="border-radius: 10px;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="slider-nav">
                    <span class="dot active"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                </div>
            </div>
        </section>

        <section id="la-fortuna" class="seccion-contenido">
            <div class="container dark-container fortuna-main-content">
                <div class="fortuna-columna-texto">
                    <h2 class="titulo-dorado">La Fortuna</h2>
                    <p class="logline">Una galleta de la fortuna para guionistas, cineastas y otros bichos raros del celuloide.</p>
                    <div class="action-buttons-container">
                        <a href="#" id="generar-fortuna-btn" class="enlace-guion">Romper Galleta</a>
                    </div>
                </div>
                <div class="fortuna-columna-animacion">
                    <div class="galleta-container">
                        <img src="imagenes/galleta-01.png" alt="Galleta de la fortuna" class="galleta-secuencia" id="galleta-secuencia-img">
                        <div class="fortuna-papel" style="display: none;">
                            <p id="fortuna-papel-texto"></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="dante-en-la-playa" class="seccion-contenido">
            <div class="container dark-container">
                <div class="dante-grid-layout">
                    <div class="dante-columna-texto">
                        <h2 class="titulo-dante">
                            Dante
                            <span class="subtitle-dante">en la playa del amor desenfrenado.</span>
                        </h2>
                        <p class="logline">
                            UN HOMBRE DESPIERTA CON RESACA EN UNA PLAYA DE BAJA CALIFORNIA SUR, DESCUBRIENDO QUE ESTÁ MUERTO Y ATRAPADO EN EL PURGATORIO. PARA ALCANZAR EL PARAÍSO, DEBE EMPRENDER UN VIAJE ESPIRITUAL A TRAVÉS DEL DESIERTO, GUIADO POR LAS MEMORias DE SU ABUELO Y LA ESPERANZA DE REENCONTRARSE CON SU AMADA BEATRIZ.
                        </p>
                        <p><strong>GÉNERO:</strong> Fantasía / Drama<br><strong>DURACIÓN:</strong> 33 Min.</p>
                    </div>
                    <div class="tarot-interactive-area">
                        <div id="tarot-result-grid">
                            <!-- Las cartas se insertarán aquí -->
                        </div>
                         <p id="tarot-instruction" style="margin-top: 1rem; font-style: italic; opacity: 0.7;">Tu lectura se revelará al llegar aquí...</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="poemas-apestosos" class="seccion-contenido seccion-poemas">
            <div class="container">
                <h2>Y UN PAR DE COCHINADAS MÁS.</h2>
                <div id="poema-display" class="dark-container" style="margin-bottom: 1rem;">
                    <h3 id="poema-titulo" class="titulo-dorado">Cargando poema...</h3>
                    <p id="poema-texto" style="white-space: pre-wrap; margin-top: 1rem; margin-bottom: 1.5rem; min-height: 150px;"></p>
                    <em id="poema-autor" style="display: block; text-align: right;"></em>
                </div>
                <div class="poemas-nav" style="text-align: center; margin-bottom: 2.5rem;">
                    <button id="prev-poema" class="poemas-nav-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="stroke: #fff;"><polyline points="15 18 9 12 15 6"></polyline></svg>
                    </button>
                    <button id="next-poema" class="poemas-nav-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="stroke: #fff;"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </button>
                </div>
                <div style="text-align: center; margin-bottom: 2rem;">
                    <a href="#" id="leer-manuscrito-btn" class="enlace-guion">Leer Manuscrito</a>
                </div>
                <div id="manuscrito-container" class="dark-container" style="display: none;">
                    <div id="manuscrito-que-es" style="margin-bottom: 1.5rem;">
                        <h4 class="titulo-dorado"></h4>
                        <p></p>
                    </div>
                    <div id="manuscrito-por-que">
                        <h4 class="titulo-dorado"></h4>
                        <p></p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-line"></div>
            <a href="#inicio" class="footer-symbols">EP</a>
            <div class="footer-line"></div>
        </div>
    </footer>

    <div id="contact-modal" class="modal-overlay">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h4>¿Quieres más sabiduría (o mala suerte)?</h4>
            <p>Déjanos tu correo o tu Instagram y te enviaremos una nueva fortuna de vez en cuando.</p>
            <input type="text" id="contact-input" placeholder="@usuario o correo@ejemplo.com">
            <a href="#" class="enlace-guion">Enviar</a>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- LÓGICA PARA EL SLIDER DE "SOBRE NOSOTROS" ---
        const slides = document.querySelector('.slides');
        const dots = document.querySelectorAll('.dot');
        if (slides && dots.length > 0) {
            let currentIndex = 0;
            function updateSlider() {
                slides.style.transform = `translateX(-${currentIndex * 100 / dots.length}%)`;
                dots.forEach((dot, index) => {
                    dot.classList.toggle('active', index === currentIndex);
                });
            }
            dots.forEach((dot, index) => {
                dot.addEventListener('click', () => {
                    currentIndex = index;
                    updateSlider();
                });
            });
        }

        // --- LÓGICA PARA LA GALLETA DE LA FORTUNA ---
        const generarFortunaBtn = document.getElementById('generar-fortuna-btn');
        const galletaImg = document.getElementById('galleta-secuencia-img');
        const fortunaPapel = document.getElementById('fortuna-papel-texto');
        const modal = document.getElementById('contact-modal');
        const closeModalBtn = document.querySelector('.modal-close');

        if (generarFortunaBtn && galletaImg && fortunaPapel && modal && closeModalBtn) {
            let fortunaGratisConcedida = false;
            let animacionEnCurso = false;

            function obtenerNuevaFortuna() {
                if (animacionEnCurso) return;
                animacionEnCurso = true;

                let frame = 1;
                const totalFrames = 8;
                galletaImg.src = `imagenes/galleta-01.png`;
                if (fortunaPapel.parentElement) {
                    fortunaPapel.parentElement.style.display = 'none';
                }

                const interval = setInterval(() => {
                    frame++;
                    if (frame <= totalFrames) {
                        galletaImg.src = `imagenes/galleta-0${frame}.png`;
                    } else {
                        clearInterval(interval);
                        fetch('fortuna') // FIX: Removed leading slash
                            .then(response => response.json())
                            .then(data => {
                                fortunaPapel.textContent = data.fortuna;
                                if (fortunaPapel.parentElement) {
                                    fortunaPapel.parentElement.style.display = 'block';
                                }
                                animacionEnCurso = false;
                            }).catch(() => animacionEnCurso = false);
                    }
                }, 100);
            }

            generarFortunaBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (!fortunaGratisConcedida) {
                    obtenerNuevaFortuna();
                    fortunaGratisConcedida = true;
                } else {
                    modal.classList.add('visible');
                }
            });
            
            closeModalBtn.addEventListener('click', () => modal.classList.remove('visible'));
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.classList.remove('visible');
            });
        }

        // --- LÓGICA PARA EL TAROT DE DANTE (CON SCROLL) ---
        const danteSection = document.getElementById('dante-en-la-playa');
        const tarotResultGrid = document.getElementById('tarot-result-grid');
        const tarotInstruction = document.getElementById('tarot-instruction');

        if (danteSection && tarotResultGrid && tarotInstruction) {
            let tarotYaRevelado = false;
            
            function getTarotReading() {
                if (tarotYaRevelado) return;
                tarotYaRevelado = true;

                fetch('tarot') // FIX: Removed leading slash
                    .then(response => response.json())
                    .then(cartas => {
                        tarotResultGrid.innerHTML = '';
                        tarotInstruction.style.display = 'none';
                        
                        cartas.forEach((carta, index) => {
                            const cardElement = document.createElement('img');
                            cardElement.src = carta.imagenUrl;
                            cardElement.alt = carta.nombre;
                            cardElement.title = `${carta.nombre}: ${carta.significado}`;
                            cardElement.classList.add('tarot-card');
                            cardElement.style.opacity = '0';
                            cardElement.style.transform = 'translateY(20px)';
                            cardElement.style.transition = `opacity 0.5s ease ${index * 0.3}s, transform 0.5s ease ${index * 0.3}s`;
                            tarotResultGrid.appendChild(cardElement);

                            setTimeout(() => {
                                cardElement.style.opacity = '1';
                                cardElement.style.transform = 'translateY(0)';
                            }, 50);
                        });
                    })
                    .catch(error => console.error('Error al obtener la lectura del tarot:', error));
            }

            const tarotObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        getTarotReading();
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.4 });

            tarotObserver.observe(danteSection);
        }
        
        // --- LÓGICA PARA POEMAS APESTOSOS ---
        const poemaTituloEl = document.getElementById('poema-titulo');
        const poemaTextoEl = document.getElementById('poema-texto');
        const poemaAutorEl = document.getElementById('poema-autor');
        const prevPoemaBtn = document.getElementById('prev-poema');
        const nextPoemaBtn = document.getElementById('next-poema');
        const leerManuscritoBtn = document.getElementById('leer-manuscrito-btn');
        const manuscritoContainer = document.getElementById('manuscrito-container');

        if (poemaTituloEl && poemaTextoEl && poemaAutorEl && prevPoemaBtn && nextPoemaBtn && leerManuscritoBtn && manuscritoContainer) {
            let todosLosPoemas = [];
            let poemaActualIndex = 0;

            function mostrarPoema(index) {
                if (!todosLosPoemas || todosLosPoemas.length === 0) return;
                const poema = todosLosPoemas[index];
                poemaTituloEl.textContent = poema.titulo;
                poemaTextoEl.textContent = poema.poema;
                poemaAutorEl.textContent = `- ${poema.autor}`;
            }

            fetch('poemas') // FIX: Removed leading slash
                .then(response => response.json())
                .then(data => {
                    todosLosPoemas = data.poemas;
                    mostrarPoema(0);
                    
                    const queEsEl = document.querySelector('#manuscrito-que-es');
                    if (queEsEl) {
                        queEsEl.querySelector('h4').textContent = data.manuscrito.queEs.titulo;
                        queEsEl.querySelector('p').textContent = data.manuscrito.queEs.texto;
                    }

                    const porQueEl = document.querySelector('#manuscrito-por-que');
                    if (porQueEl) {
                        porQueEl.querySelector('h4').textContent = data.manuscrito.porQue.titulo;
                        porQueEl.querySelector('p').textContent = data.manuscrito.porQue.texto;
                    }
                })
                .catch(error => {
                    console.error('Error al cargar la sección de poemas:', error);
                });

            nextPoemaBtn.addEventListener('click', () => {
                poemaActualIndex = (poemaActualIndex + 1) % todosLosPoemas.length;
                mostrarPoema(poemaActualIndex);
            });
            prevPoemaBtn.addEventListener('click', () => {
                poemaActualIndex = (poemaActualIndex - 1 + todosLosPoemas.length) % todosLosPoemas.length;
                mostrarPoema(poemaActualIndex);
            });
            leerManuscritoBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const isHidden = manuscritoContainer.style.display === 'none';
                manuscritoContainer.style.display = isHidden ? 'block' : 'none';
                leerManuscritoBtn.textContent = isHidden ? 'Ocultar Manuscrito' : 'Leer Manuscrito';
            });
        }
    });
    </script>
</body>
</html>
